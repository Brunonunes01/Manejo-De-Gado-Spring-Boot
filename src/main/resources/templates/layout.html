<!DOCTYPE html>
<html lang="pt-br"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${titulo} ?: 'Manejo de Gado'"></title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <style>
        :root {
            /* Paleta Agro Profissional */
            --primary-color: #1b4332;      /* Verde Floresta Escuro - Profissional */
            --secondary-color: #2d6a4f;    /* Verde Médio */
            --accent-color: #d8f3dc;       /* Verde Claro Suave (Fundo de detalhes) */
            --highlight-color: #e09f3e;    /* Dourado/Trigo (Para destaques sutis) */
            --text-dark: #2c3e50;
            --text-light: #95a5a6;
            --white: #ffffff;

            --sidebar-width: 260px;
            --header-height: 70px;
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        body {
            background-color: #f8f9fa; /* Cinza bem claro profissional */
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* --- NAVBAR (Topo) --- */
        .navbar-agro {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            height: var(--header-height);
            z-index: 1001;
            padding-left: var(--sidebar-width); /* Deixa espaço para a sidebar */
            transition: padding-left 0.3s;
        }

        /* Área da Logo no topo da Sidebar */
        .navbar-brand-wrapper {
            width: var(--sidebar-width);
            height: var(--header-height);
            background-color: var(--primary-color);
            position: fixed;
            top: 0;
            left: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1002;
            color: white;
            font-weight: bold;
            font-size: 1.3rem;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            text-decoration: none;
        }

        .navbar-brand-wrapper:hover {
            color: white;
        }

        .navbar-brand-wrapper i {
            font-size: 1.5rem;
            margin-right: 10px;
            color: var(--highlight-color);
        }

        /* --- SIDEBAR (Lateral) --- */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background-color: var(--primary-color);
            padding-top: 20px;
            overflow-y: auto;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 0 25px;
            margin-bottom: 15px;
            margin-top: 15px;
            color: rgba(255,255,255,0.5);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
        }

        .sidebar-item {
            padding: 12px 25px;
            display: flex;
            align-items: center;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.2s;
            border-left: 4px solid transparent;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .sidebar-item:hover {
            background-color: rgba(255,255,255,0.05);
            color: white;
        }

        .sidebar-item.active {
            background-color: rgba(255,255,255,0.1);
            color: white;
            border-left-color: var(--highlight-color); /* O detalhe dourado */
        }

        .sidebar-item i {
            width: 24px;
            margin-right: 10px;
            font-size: 1.1rem;
            text-align: center;
        }

        /* --- CONTEÚDO PRINCIPAL --- */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 30px;
            min-height: 100vh;
            transition: margin-left 0.3s;
        }

        /* --- CARDS (Melhoria Visual) --- */
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: var(--shadow-card);
            background: white;
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: translateY(-3px); /* Efeito sutil de levantar */
        }

        .card-header {
            background-color: transparent;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding: 1.2rem 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* --- TÍTULOS DAS PÁGINAS --- */
        .page-header {
            margin-bottom: 2rem;
            border-left: 5px solid var(--primary-color);
            padding-left: 1.5rem;
            background: transparent;
            box-shadow: none;
        }

        .page-title {
            font-weight: 700;
            color: var(--text-dark);
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Badge de Status Elegante */
        .badge-agro {
            background-color: var(--secondary-color);
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.85rem;
        }

        /* Responsividade */
        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); }
            .main-content { margin-left: 0; }
            .navbar-agro { padding-left: 0; }
            .navbar-brand-wrapper { width: 100%; height: 60px; position: relative; }
            .sidebar.show { transform: translateX(0); }
        }
    </style>
</head>
<body>

<a class="navbar-brand-wrapper" th:href="@{/}">
    <i class="bi bi-buildings-fill"></i>
    <span>AgroGestão</span>
</a>

<nav class="navbar navbar-expand-lg navbar-agro">
    <div class="container-fluid px-4">
        <button class="btn border-0 d-lg-none me-2" onclick="toggleSidebar()">
            <i class="bi bi-list fs-3"></i>
        </button>

        <div class="ms-auto d-flex align-items-center gap-3">
            <span class="text-muted d-none d-md-block small">
                <i class="bi bi-clock me-1"></i> Sistema de Gestão Rural
            </span>
            <div class="vr d-none d-md-block mx-2"></div>
            <div class="dropdown">
                <button class="btn btn-light border rounded-pill px-3 d-flex align-items-center gap-2"
                        type="button" data-bs-toggle="dropdown">
                    <div class="bg-success rounded-circle text-white d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                        <i class="bi bi-person-fill"></i>
                    </div>
                    <span class="small fw-bold text-dark">Admin</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end shadow border-0 mt-2">
                    <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Meu Perfil</a></li>
                    <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Configurações</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item text-danger" href="#"><i class="bi bi-box-arrow-right me-2"></i>Sair</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<aside class="sidebar" id="sidebar">
    <div class="sidebar-header">Navegação Principal</div>
    <nav>
        <a class="sidebar-item" th:href="@{/}" th:classappend="${paginaAtiva == 'home'} ? 'active' : ''">
            <i class="bi bi-speedometer2"></i> <span>Visão Geral</span>
        </a>
        <a class="sidebar-item" th:href="@{/animais}" th:classappend="${paginaAtiva == 'animais'} ? 'active' : ''">
            <i class="bi bi-tags-fill"></i> <span>Rebanho</span>
        </a>
        <a class="sidebar-item" th:href="@{/lotes}" th:classappend="${paginaAtiva == 'lotes'} ? 'active' : ''">
            <i class="bi bi-grid-3x3"></i> <span>Lotes & Pastos</span>
        </a>
        <a class="sidebar-item" th:href="@{/vacinas}" th:classappend="${paginaAtiva == 'vacinas'} ? 'active' : ''">
            <i class="bi bi-capsule"></i> <span>Sanitário (Vacinas)</span>
        </a>
        <a class="sidebar-item" th:href="@{/pesagens}" th:classappend="${paginaAtiva == 'pesagens'} ? 'active' : ''">
            <i class="bi bi-bar-chart-line"></i> <span>Controle de Peso</span>
        </a>
        <a class="sidebar-item" th:href="@{/aplicacoes}" th:classappend="${paginaAtiva == 'aplicacoes'} ? 'active' : ''">
            <i class="bi bi-clipboard-check"></i> <span>Aplicações</span>
        </a>

        <div class="sidebar-header">Administração</div>

        <a class="sidebar-item" th:href="@{/usuarios}" th:classappend="${paginaAtiva == 'usuarios'} ? 'active' : ''">
            <i class="bi bi-people"></i>
            <span>Equipe</span>
        </a>
    </nav>
</aside>

<main class="main-content" layout:fragment="conteudo">
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

<script>
    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('show');
    }

    // Fecha sidebar ao clicar fora no mobile
    document.addEventListener('click', function(event) {
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.querySelector('.d-lg-none');

        if (window.innerWidth <= 992 && sidebar.classList.contains('show')) {
            if (!sidebar.contains(event.target) && !toggleBtn.contains(event.target)) {
                sidebar.classList.remove('show');
            }
        }
    });
</script>

</body>
</html>